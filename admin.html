<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#f5f5f5;padding:20px}
.card{background:#fff;padding:20px;border-radius:12px;max-width:500px;margin:auto}
input,button{width:100%;padding:10px;margin-top:6px;border-radius:8px}
.add{background:#4caf50;color:#fff}
.edit{background:#2196f3;color:#fff}
.del{background:#f44336;color:#fff}
.row{border-bottom:1px solid #ddd;padding:8px 0}
</style>
</head>
<body>

<div class="card">
<h2>Admin</h2>

<h3>เพิ่มแต้มให้ผู้ใช้</h3>
<input id="u" placeholder="ชื่อผู้ใช้">
<input id="p" type="number" placeholder="จำนวนแต้ม">
<button class="add" onclick="addPoint()">➕ เพิ่มแต้ม</button>

<hr>
<h3>จัดการของรางวัล</h3>
<input id="rname" placeholder="ชื่อรางวัล">
<input id="rcost" type="number" placeholder="แต้มที่ใช้">
<button class="add" onclick="saveReward()">บันทึก</button>

<div id="list"></div>
</div>

<script>
let rewards=JSON.parse(localStorage.getItem('rewards')||'[]');
let edit=null;

function addPoint(){
  let users=JSON.parse(localStorage.getItem('data')||'{}');
  if(!u.value||p.value<=0) return alert('ข้อมูลไม่ถูกต้อง');
  if(!users[u.value]) users[u.value]={password:'',points:0};
  users[u.value].points+=Number(p.value);
  localStorage.setItem('data',JSON.stringify(users));
  alert('เพิ่มแต้มเรียบร้อย');
  u.value=p.value='';
}

function saveReward(){
  if(!rname.value||rcost.value<=0) return alert('ข้อมูลไม่ถูกต้อง');
  if(edit!=null){ rewards[edit]={name:rname.value,cost:Number(rcost.value)}; edit=null; }
  else rewards.push({name:rname.value,cost:Number(rcost.value)});
  localStorage.setItem('rewards',JSON.stringify(rewards));
  rname.value=rcost.value='';
  render();
}

function editReward(i){
  rname.value=rewards[i].name;
  rcost.value=rewards[i].cost;
  edit=i;
}

function delReward(i){
  if(confirm('ลบของรางวัล?')){
    rewards.splice(i,1);
    localStorage.setItem('rewards',JSON.stringify(rewards));
    render();
  }
}

function render(){
  list.innerHTML='';
  rewards.forEach((r,i)=>{
    list.innerHTML+=`
    <div class="row">
    ${r.name} (${r.cost} แต้ม)
    <button class="edit" onclick="editReward(${i})">✏️</button>
    <button class="del" onclick="delReward(${i})">❌</button>
    </div>`;
  });
}
render();
</script>
</body>
</html>
